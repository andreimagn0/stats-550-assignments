---
title: 'Lab 2: Basic Probability'
author: "Andrei Dominic Magno"
date: "2026-02-13"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

In this lab we will work through two basic probability problems, and in the process practice more with RMarkdown.

#### Packages Needed:

knitr, xtable, pander


## Task 1: Coin Flipping

This task illustrates the interpretation of a probability as the long run relative frequency of an event after a large number of trials. 

Dobrow presents R code on pages 24 and 453 for simulating coin tosses. We perform the experiment of observing the number of heads after tossing a fair coin 100 times (probability of a heads on any one toss is 50%). Just like rolling a die, we can use the R function `sample` to flip a coin. Though recognize there are only two outcomes: heads (1) and tails (0). We will report the number of heads after 50 tosses and its intermediary output. We will also graphically display the cumulative proportion of heads against the coin toss (1 to 100). The `type="l"` parameter in the R function `plot` will draw a solid line.  *Always label your axes! In RMarkdown, a graph title is useful too.*

### Code Set-Up

```{r dobrow_coinflips}
simnum = 100 # number of coin flips
coinflips = sample(0:1, simnum, replace = TRUE) # flip the coin: heads = 1, tails = 0
heads = cumsum(coinflips) # cumulative sum of number of heads after each coin toss
prop = heads/(1:simnum) # running proportion of heads after each coin toss
head(heads) # report cumulative number of heads after each of the first 6 flips
heads[50]
# running mean plot for proportion of heads
plot(1:simnum, prop, type = "l", xlab = "Number of coins", ylab = "Running average", main = "Proportion of heads in 100 coin flips")
abline(h = 0.5) # add a line at 50%
```

### The Problem

Let us now flip a "biased" coin. Perform the experiment of observing the number of heads after tossing a coin 1000 times, with the probability of getting a head on any one toss being 40%. To change the probability in the R function `sample`, use the parameter `prob = c(0.6, 0.4)`; note that we need to specify the probability of tails (0) and heads (1) in this parameter. Note that if you do not want the code presented in your html report, use the parameter `echo=FALSE` in the code chunk.

#### Report the Following:

* Proportion of heads after 10, 50, 100, 200, and 500 tosses (see table code chunk below under "RMarkdown presenting output"!)

* Plot of the cumulative proportion of heads vs. coin toss number (1 to 1000); label the axes and title the graphic appropriately!

* On the plot, draw a horizontal line at *y = 0.40*, the probability of tossing a head for this coin.


```{r coin_toss, echo=TRUE}
# [Place Code Here]
simnum = 1000 # number of coin flips
coinflips = sample(c(0,1), simnum, replace = TRUE, prob = c(0.6, 0.4)) # flip the coin: heads = 1, tails = 0
heads = cumsum(coinflips) # cumulative sum of number of heads after each coin toss
prop = heads/(1:simnum) # running proportion of heads after each coin toss
head(heads) # report cumulative number of heads after each of the first 6 flips
heads[50]
# running mean plot for proportion of heads
plot(1:simnum, prop, type = "l", xlab = "coin toss number", ylab = "cumulative proportion of heads", main = "Proportion of heads in 1000 coin flips")
abline(h = 0.4) # add a line at 40%
```

### Questions:

* Describe the behavior of the graphic (cumulative proportion of heads) during the first 150 tosses (1-150), proceeding 150 tosses (151-300), and then later tosses.

*During the first 150 tosses, the graph fluctuates a bit and is noticeably volatile as each individual toss has a huge impact on the running proportion. During the next 151-300 tosses, the curve starts to stabilize and fluctuates less with more tosses. After 300 tosses, the curve continues to normalize towards 0.40.*

* What do you notice about the limiting value of the curve in your plot?

*The curve appears to approach the limiting value of the curve in the plot as the number of tosses increases.*

* Why would you expect the behavior you discuss in the previous two bullets?

*This behavior is expected due to the Law of Large Numbers. As the number of tosses increases, the sample proportion gets closer to the true probability, which is directly shown in the graph.*



#### RMarkdown Presenting Output: 

Below is code to present a table for the proportion of heads after 10, 50, and 100 tosses.

Reminders:

The `echo=FALSE` parameter prevents printing of code from a code chunk.
The `include=FALSE` parameter prevents printing of output from a code chunk.
The `results=asis` allows the LaTeX code produced by xtable to be compiled and output.


```{r toss_table, echo=TRUE, results='asis', warning=FALSE}
# we will create a table using xtable and pander
library(knitr)
library(xtable)
library(pander)
# output desired summary statistics
# formatC used so integer coin tosses do not have a decimal place in the figure!
numtoss = formatC(c(10, 50, 100, 200, 500), digits = 0, format = "d", flag = "#")
num.heads = c(heads[10], heads[50], heads[100], heads[200], heads[500])
num.heads = formatC(num.heads, digits = 0, format = "d", flag = "#")
# formatC used here so proportions have exactly two decimal places (including zeros at the end)!
prop.heads = c(prop[10], prop[50], prop[100], prop[200], prop[500])
prop.heads = formatC(signif(prop.heads, digits = 6), digits = 2, format = "f", flag = "#")
table.elts = rbind(numtoss, num.heads, prop.heads)
row.names(table.elts) = cbind("Number of coins tosses", "Number of heads", "Proportion of heads")
lab1.table = xtable(table.elts, caption = "Proportion of heads for a given number of tosses of a coin with P(Head) = 0.40.", label="cointoss", align = "|l|rrrrr|")
pander(lab1.table)
```

The table shows the proportion of heads after a certain number of tosses in a single simulation experiment. These proportions provide empirical estimates for the probability of a head for specified simulation sample sizes.

### The Problem

Directly in the code chunk above, add columns for 200 tosses and 500 tosses.  Hint: you will need to append these two elements to `numtoss`, `num.heads`, and `prop.heads`. Also, note that in the `xtable` function, the align is only for 3 right-justified columns; you'll need to augment that to 5 right-justified columns.


## Task 2: Divisibility Probability

This task provides a probability problem to explore if-then statements and functions in R. Consider an integer drawn uniformly at random from the numbers {1, 2, ..., 1000} such that each number is equally likely. We wish to simulate the probability that the number drawn is divisible by 3, 5, or 6.

### Code Set-Up

Dobrow presents R code on page 25 for simulating this experiment, and provides the exact probability calculation in Example 1.20. The code presents a slick application of the `replicate` R function, one we used in the "Introduction to R" lab. In particular, a function is written which draws the number at random from the integers 1 to 1000 and then checks if it is divisible by 3, 5, or 6. It uses modular arithmetic, `x%%n` being *x mod n* in R. For example, if the remainder of the number divided by 3 (modulus) is 0, then the number is divisible by 3!  We will then repeat the function (experiment) 1000 times to get the empirical probability.

##### The true probability that a randomly drawn integer between 1 and 1000 is divisible by 3, 5, or 6 is 0.467.

```{r divisible356}
# simdivis() simulates one trial
simdivis = function()
{
  num = sample(1:1000, 1) # draw a number at random from the integers 1 to 1000
  # determine if the number is divisible by 3, 5 or 6 by checking if the remainder is 0
  if (num%%3==0 || num%%5==0 | num%%6==0) 1 else 0
}
simlist = replicate(1000, simdivis()) # replicate the experiment 1000 times
mean(simlist) # compute the estimated probability as the proportion of times the number is divisible by 3, 5, or 6
```


### The Problem

Simulate the probability that a random integer between 1 and 5000 is divisible by 4, 7, or 10.

##### The true probability that a randomly drawn integer between 1 and 5000 is divisible by 4, 7, or 10 is 0.40.

```{r divisible4710}
# [Place Code Here]
# simdivis() simulates one trial
simdivis = function()
{
  num = sample(1:5000, 1) # draw a number at random from the integers 1 to 5000
  # determine if the number is divisible by 4, 7 or 10 by checking if the remainder is 0
  if (num%%4==0 || num%%7==0 | num%%10==0) 1 else 0
}
simlist = replicate(100000, simdivis()) # replicate the experiment 1000 times
mean(simlist) # compute the estimated probability as the proportion of times the number is divisible by 4, 7 or 10
```

### Questions:

* Present the empirical probability based on repeating the experiment 100, 1000, 10000, and 100000 times. Consider using the `xtable` code chunk from the first task to build a table for these values.

*The empirical probabilities are: p(100) = 0.37, p(1000) = 0.408, p(10000) =  0.4039, and p(100000) = 0.39924.*

* How do these values compare to the truth?

*Since the true probability is 0.40, as the number of repetitions increase, the empirical probability gets closer to 0.40.*

* Extra credit: show that the true probability of a random integer between 1 and 5000 being divisible by 4, 7, or 10 is 40%.

*P(A∪B∪C) = P(A) + P(B) + P(C) - P(AB) - P(AC) - P(BC) + P(ABC); P(A) = ⌊5000 / 4⌋/5000 = 0.25, P(B) = ⌊5000 / 7⌋/5000 = 0.1428, P(C) = ⌊5000 / 10⌋/5000 = 0.10*
*(A∪B∪C) = 0.25 + 0.1428 + 0.10 - 0.0356 - 0.05 - 0.0142 + 0.007 = 0.40*

